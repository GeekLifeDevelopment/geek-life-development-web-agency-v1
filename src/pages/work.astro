---
import { getCollection } from 'astro:content';
import Layout from '../components/Layout.astro';
import Badge from '../components/ui/Badge.astro';
import Button from '../components/ui/Button.astro';
import Card from '../components/ui/Card.astro';
import Heading from '../components/ui/Heading.astro';
import Section from '../components/ui/Section.astro';
import { getWorkImages } from '../data/workImages';

const studies = (await getCollection('work')).sort((a, b) => a.data.title.localeCompare(b.data.title));
---

<Layout title="Work | Geek Life Development" description="Review case studies showing how Geek Life Development plans, builds, and launches modern websites and simple web apps.">
  <Section>
    <div class="max-w-4xl space-y-6">
      <h1 class="text-4xl md:text-6xl">Work</h1>
      <p class="text-base text-[var(--color-neutral)] md:text-lg">Modern websites and simple apps with real build notes and outcomes.</p>
      <div class="flex flex-wrap gap-3">
        <Button href="/contact" size="lg">Get a quote</Button>
      </div>
    </div>
  </Section>

  <Section variant="muted">
    <div class="space-y-10">
      <Heading
        eyebrow="Case studies"
        title="Proof from real projects"
        subtitle="Each project includes implementation notes and practical build decisions, not just outbound links."
      />

      <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
      {
        studies.map((study) => {
          const images = getWorkImages(study.slug);

          return (
            <Card class="relative flex h-full flex-col overflow-hidden p-0">
              {images && (
                <picture class="absolute inset-0">
                  <source media="(max-width: 767px)" srcset={images.mobile.src} />
                  <img src={images.desktop.src} alt={images.alt} class="h-full w-full object-cover" loading="lazy" />
                </picture>
              )}
              <div class="absolute inset-0 bg-gradient-to-t from-slate-950/90 via-slate-950/70 to-slate-950/45"></div>

              <div class="relative z-10 flex h-full flex-col p-6">
                <h2 class="text-2xl text-white [text-shadow:0_2px_12px_rgba(0,0,0,0.55)]">{study.data.title}</h2>
                <p class="mt-3 text-sm text-slate-100 [text-shadow:0_1px_8px_rgba(0,0,0,0.5)]">{study.data.summary}</p>
                <div class="mt-4 flex flex-wrap gap-2 text-xs">
                  {study.data.tags.map((tag) => <Badge variant="neutral">{tag}</Badge>)}
                </div>
                <div class="mt-6 flex flex-wrap gap-2">
                  <Button href={`/work/${study.slug}`} variant="secondary" size="sm">
                    View case study
                  </Button>
                  <a
                    href={study.data.websiteUrl}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="inline-flex h-9 items-center justify-center rounded-xl border border-slate-200/90 bg-white/10 px-4 text-sm font-medium text-white transition hover:-translate-y-0.5 hover:bg-white/20 hover:no-underline"
                  >
                    Visit site
                  </a>
                </div>
              </div>
            </Card>
          );
        })
      }
      </div>

      <p class="text-sm text-slate-600">More case studies coming soon.</p>
    </div>
  </Section>
</Layout>